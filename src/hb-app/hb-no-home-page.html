<link rel="import" href="../../bower_components/polymer/polymer-element.html">
<link rel="import" href="../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html">
<link rel="import" href="../../bower_components/app-layout/app-drawer-layout/app-drawer-layout.html">
<link rel="import" href="../../bower_components/app-layout/app-drawer/app-drawer.html">
<link rel="import" href="../../bower_components/app-layout/app-drawer-layout/app-drawer-layout.html">
<link rel="import" href="../../bower_components/app-layout/app-header/app-header.html">
<link rel="import" href="../../bower_components/app-layout/app-header-layout/app-header-layout.html">
<link rel="import" href="../../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html">
<link rel="import" href="../../bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../hb-styles/hb-styles.html">
<link rel="import" href="add-document-page.html">
<link rel="import" href="hb-menu.html">
<link rel="import" href="hb-config.html">
<link rel="import" href="hb-current-user.html">
<link rel="import" href="hb-system-data.html">
<link rel="import" href="../hb/hb.hb-art-doc.html">

<dom-module id="hb-no-home-page">
    <template>
        <style include="hb-page-layout-shared-styles"></style>
        <style>
            :host {
                --message-text-color: rgba(255,255,255, 0.9);
            }

            .message {
                cursor: default;
                margin: .5rem;
                xwidth: 100%;
                padding: 4rem 1rem;                
                text-align: center;
                background: rgba(0, 0, 0, 0.6);
                border-radius: 3px;
            }

            .message .text {
                font-size: 2rem;
                color: var(--message-text-color);                
            }

            .message paper-button {
                margin-top: 2em;
                font-weight: normal;
                color: var(--message-text-color);          
            }
        </style>
        <hb-config config="{{config}}"></hb-config>
        <hb-current-user user="{{user}}"></hb-current-user>
        <hb-system-data></hb-system-data>
        <app-drawer-layout id="drawerLayout" force-narrow>
            <app-drawer id="drawer" slot="drawer" swipe-open>
                <hb-menu></hb-menu>
            </app-drawer>
            <app-header-layout>
                <app-header slot="header" fixed effects="waterfall">
                    <app-toolbar>
                        <paper-icon-button icon="hb:menu" drawer-toggle></paper-icon-button>
                        <div main-title>
                            [[config.applicationTitle]]
                        </div>
                    </app-toolbar>
                </app-header>
                <main>
                <!-- main content -->
                    <div class="message" hidden$="[[user.permissions.isSiteAdmin]]">
                        <div class="text">
                            Coming soon...
                        </div>
                    </div>
                    <div class="message" hidden$="[[!user.permissions.isSiteAdmin]]">
                        <div class="text">
                            No home
                        </div>
                        <paper-button on-tap="addHome">Add the home page</paper-button>
                    </div>
                </main>
            </app-header-layout>
        </app-drawer-layout> 
    </template>
    <script>
    /**
     * @customElement
     * @polymer
     */
    class HbNoHomePage extends Polymer.Element {
        static get is() { return 'hb-no-home-page'; }
    
        static get properties() {
            return {
                user: {
                    type: Object
                }
            };
        }

        addHome(event) {
            const close = () => {
                addDoc.remove();
                document.body.appendChild(this);
            };
            
            const addDoc = document.createElement("add-document-page");
            addDoc.title = "Add the home page";

            addDoc.addEventListener("closed", () =>  close());
            addDoc.addEventListener("add-new", async event => {
                close();
                const {title, is} = event.detail;
                this.dispatchEvent(new CustomEvent("create-home-page", {
                    bubbles: true,
                    composed: true,
                    detail: {title, is}
                }));                
            });
            
            

            addDoc.addEventListener("add-existing", event => {
                close();
                alert("Add exising from no home page...");
            });

            this.remove();
            document.body.appendChild(addDoc);
        }    
    }
    
    window.customElements.define(HbNoHomePage.is, HbNoHomePage);
    </script>
            
</dom-module>
